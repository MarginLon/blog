(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{394:function(n,l,i){"use strict";i.r(l);var v=i(7),s=Object(v.a)({},(function(){var n=this,l=n._self._c;return l("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[l("ul",[l("li",[l("a",{attrs:{href:"#1-http%E7%BD%91%E7%BB%9C%E5%B1%82"}},[n._v("1. HTTP网络层")])]),n._v(" "),l("li",[l("a",{attrs:{href:"#2-%E8%B7%A8%E5%9F%9F%E6%96%B9%E6%A1%88"}},[n._v("2. 跨域方案")])])]),n._v(" "),l("h2",{attrs:{id:"_1-http网络层"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#_1-http网络层"}},[n._v("#")]),n._v(" 1. HTTP网络层")]),n._v(" "),l("ul",[l("li",[n._v("http vs https\n"),l("ul",[l("li",[n._v("超文本传输协议(s: ssl加密) 端口号:80 443")]),n._v(" "),l("li",[n._v("ftp:文件上传下载协议 端口号: 21")])])]),n._v(" "),l("li",[n._v("页面 [第一次访问]\n"),l("ol",[l("li",[l("p",[n._v("URL解析")]),n._v(" "),l("ul",[l("li",[n._v("地址解析\n"),l("ul",[l("li",[n._v("协议://登录信息@域名:端口号/请求资源的文件路径?查询字符串#片段标识符(HASH)")]),n._v(" "),l("li",[n._v("问号参数\n"),l("ul",[l("li",[n._v("客户端 -> 服务器 GET请求")]),n._v(" "),l("li",[n._v("A页面 -> B页面")])])]),n._v(" "),l("li",[n._v("HASH\n"),l("ul",[l("li",[n._v("锚点定位")]),n._v(" "),l("li",[n._v("HASH路由")])])])])]),n._v(" "),l("li",[n._v("编码")])]),n._v(" "),l("div",{staticClass:"language-js line-numbers-mode"},[l("pre",{pre:!0,attrs:{class:"language-js"}},[l("code",[n._v("encodeURI\ndecodeURI\nencodeURIComponent\ndecodeURLComponent\nescape unescape\n")])]),n._v(" "),l("div",{staticClass:"line-numbers-wrapper"},[l("span",{staticClass:"line-number"},[n._v("1")]),l("br"),l("span",{staticClass:"line-number"},[n._v("2")]),l("br"),l("span",{staticClass:"line-number"},[n._v("3")]),l("br"),l("span",{staticClass:"line-number"},[n._v("4")]),l("br"),l("span",{staticClass:"line-number"},[n._v("5")]),l("br")])])]),n._v(" "),l("li",[l("p",[n._v("URL解析")])]),n._v(" "),l("li",[l("p",[n._v("缓存检查 [第二次访问]")]),n._v(" "),l("ul",[l("li",[n._v("Memory Cache; Disk Cache\n"),l("ul",[l("li",[n._v("打开网页：查找 disk cache 中是否有匹配，如有则使用，如没有则发送网络请求")]),n._v(" "),l("li",[n._v("普通刷新 (F5)：因TAB没关闭，因此memory cache是可用的，会被优先使用，其次才是disk cache")]),n._v(" "),l("li",[n._v("强制刷新 (Ctrl + F5)：浏览器不使用缓存，因此发送的请求头部均带有 Cache-control: no-cache，服务器直接返回 200 和最新内容")])])]),n._v(" "),l("li",[n._v("资源文件\n"),l("ul",[l("li",[n._v("强缓存 ：先看强缓存，强制缓存，有缓存则用缓存[html页面不能强缓存 资源文件设置时间戳/webpack生成新文件]\n"),l("ul",[l("li",[n._v("Expires: 缓存过期时间")]),n._v(" "),l("li",[n._v("Cache-Control:（优先）max-age = 2592000")])])]),n._v(" "),l("li",[n._v("协商缓存: 304\n"),l("ul",[l("li",[n._v("Last-Modified / ETag")]),n._v(" "),l("li",[n._v("先向服务器发请求,传递Etag等值，一样：没更新，返回304，从缓存拿文件；不一样：更新，返回200，从服务器拿文件并加入缓存")])])])])]),n._v(" "),l("li",[n._v("数据信息 api\n"),l("ul",[l("li",[n._v("自己处理[cookie,localStorage,sessinoStorage,vue/redux...]")])])])])]),n._v(" "),l("li",[l("p",[n._v("DNS解析 找到ip [20-120ms]")]),n._v(" "),l("ul",[l("li",[n._v("递归查询\n"),l("ul",[l("li",[n._v("客户端 -> 浏览器缓存 -> 本地hosts -> 本地DNS解析器缓存 -> 本地DNS服务器 -> 客户端(逐级探测)")])])]),n._v(" "),l("li",[n._v("迭代查询\n"),l("ul",[l("li",[n._v("客户端 -> 本地DNS服务器 -> 根域名 -> 本地DNS服务器 -> 顶级域名 -> 本地DNS服务器 -> ... -> 客户端")])])]),n._v(" "),l("li",[n._v("减少DNS请求次数/ dns-prefetch")])])]),n._v(" "),l("li",[l("p",[n._v("TCP三次握手 找到服务器并建立通信通道")]),n._v(" "),l("ul",[l("li",[n._v("TCP作为一种可靠传输控制协议，其核心思想：既要保证数据可靠传输，又要提高传输的效率！")])])]),n._v(" "),l("li",[l("p",[n._v("通信")]),n._v(" "),l("ul",[l("li",[n._v("HTTP报文：请求报文/响应报文")]),n._v(" "),l("li",[n._v("状态码:\n- 200：OK\n- 202 Accepted: 服务器接受请求，未处理（异步）\n- 204 No Content： 服务器已经处理了请求，不需要返回实体内容\n- 206 Partial Content:成功处理了GET请求\n- 301 Moved Permanently 永久转移 [域名迁移]\n- 302 Move Temporarily 临时转移 [负载均衡]\n- 304 Not Modified 读取的是协商缓存的数据\n- 305 Use Proxy\n- 400 Bad Request : 请求参数有误\n- 401 Unauthorized：权限（Authorization）\n- 403 Forbidden\n- 404 Not Found\n- 405 Method Not Allowed\n- 408 Request Timeout\n- 500 Internal Server Error\n- 503 Service Unavailable\n- 505 HTTP Version Not Supported")])])]),n._v(" "),l("li",[l("p",[n._v("TCP四次挥手")]),n._v(" "),l("ul",[l("li",[n._v("服务器端收到客户端的SYN连接请求报文后，可以直接发送SYN+ACK报文")]),n._v(" "),l("li",[n._v("但关闭连接时，当服务器端收到FIN报文时，很可能并不会立即关闭链接，所以只能先回复一个ACK报文，告诉客户端：”你发的FIN报文我收到了”，只有等到服务器端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送，故需要四步握手。")]),n._v(" "),l("li",[n._v("Connection: keep-alive")])])]),n._v(" "),l("li",[l("p",[n._v("页面渲染")])])])]),n._v(" "),l("li",[n._v("HTTP1.0 1.1 2.0\n"),l("ul",[l("li",[n._v("1.0 vs 1.1\n"),l("ul",[l("li",[n._v("缓存标识")]),n._v(" "),l("li",[n._v("连接带宽优化：1.1断点续传 ： 206")]),n._v(" "),l("li",[n._v("错误通知： 1.1新增24个错误状态码 409 410...")]),n._v(" "),l("li",[n._v("Host头处理;")]),n._v(" "),l("li",[n._v("1.1 长连接 Connection: keep-alive")])])]),n._v(" "),l("li",[n._v("2.0 vs 1.X\n"),l("ul",[l("li",[n._v("新的二进制格式：")]),n._v(" "),l("li",[n._v("header压缩：编码压缩")]),n._v(" "),l("li",[n._v("服务端推送：服务器会多推送文件")])])]),n._v(" "),l("li",[n._v("多路复用\n"),l("ul",[l("li",[n._v("HTTP/1.0  每次请求响应，建立一个TCP连接，用完关闭")]),n._v(" "),l("li",[n._v("HTTP/1.1 「长连接」 若干个请求排队串行化单线程处理，后面的请求等待前面请求的返回才能获得执行机会，一旦有某请求超时等，后续请求只能被阻塞，毫无办法，也就是人们常说的线头阻塞；")]),n._v(" "),l("li",[n._v("HTTP/2.0 「多路复用」多个请求可同时在一个连接上并行执行，某个请求任务耗时严重，不会影响到其它连接的正常执行；")])])])])]),n._v(" "),l("li",[n._v("数据缓存\n"),l("ul",[l("li",[n._v("第一次从服务器获取，存储在本地并设置有效周期\n"),l("ul",[l("li",[n._v("cookie\n"),l("ul",[l("li",[n._v("设置cookie时设置有效期")]),n._v(" "),l("li",[n._v("最多4kb")]),n._v(" "),l("li",[n._v("非跨域请求下，如果本地有cookie，每一次发送请求，都默认把cookie基于请求头传递给服务器。")])])]),n._v(" "),l("li",[n._v("localStorage\n"),l("ul",[l("li",[n._v("持久化，除非手动删除或卸载浏览器")]),n._v(" "),l("li",[n._v("最多5MB")]),n._v(" "),l("li",[n._v("默认和服务器无关")])])]),n._v(" "),l("li",[n._v("sessionStorage\n"),l("ul",[l("li",[n._v("会话存储，页面关闭消失，刷新不会。")])])]),n._v(" "),l("li",[n._v("虚拟内存\n"),l("ul",[l("li",[n._v("页面刷新或者关闭时释放")])])])])]),n._v(" "),l("li",[n._v("以后发请求，校验本地缓存。")])])])]),n._v(" "),l("div",{staticClass:"language-js line-numbers-mode"},[l("pre",{pre:!0,attrs:{class:"language-js"}},[l("code",[l("span",{pre:!0,attrs:{class:"token comment"}},[n._v("/*\n *     1.利用缓存\n *       + 对于静态资源文件实现强缓存和协商缓存（扩展：文件有更新，如何保证及时刷新？）  \n *       + 对于不经常更新的接口数据采用本地存储做数据缓存（扩展：cookie / localStorage / vuex|redux 区别？）\n *     2.DNS优化\n *       + 分服务器部署，增加HTTP并发性（导致DNS解析变慢）\n *       + DNS Prefetch\n *     3.TCP的三次握手和四次挥手\n *       + Connection:keep-alive\n *     4.数据传输\n *       + 减少数据传输的大小\n *         + 内容或者数据压缩（webpack等）\n *         + 服务器端一定要开启GZIP压缩（一般能压缩60%左右）\n *         + 大批量数据分批次请求（例如：下拉刷新或者分页，保证首次加载请求数据少）\n *       + 减少HTTP请求的次数\n *         + 资源文件合并处理\n *         + 字体图标\n *         + 雪碧图 CSS-Sprit\n *         + 图片的BASE64\n *       + ......\n *     5.CDN服务器“地域分布式”\n *     6.采用HTTP2.0\n * ==============\n * 网络优化是前端性能优化的中的重点内容，因为大部分的消耗都发生在网络层，尤其是第一次页面加载，如何减少等待时间很重要“减少白屏的效果和时间”\n *     + LOADDING 人性化体验\n *     + 骨架屏：客户端骨屏 + 服务器骨架屏\n *     + 图片延迟加载\n *     + ....\n */")]),n._v("\n")])]),n._v(" "),l("div",{staticClass:"line-numbers-wrapper"},[l("span",{staticClass:"line-number"},[n._v("1")]),l("br"),l("span",{staticClass:"line-number"},[n._v("2")]),l("br"),l("span",{staticClass:"line-number"},[n._v("3")]),l("br"),l("span",{staticClass:"line-number"},[n._v("4")]),l("br"),l("span",{staticClass:"line-number"},[n._v("5")]),l("br"),l("span",{staticClass:"line-number"},[n._v("6")]),l("br"),l("span",{staticClass:"line-number"},[n._v("7")]),l("br"),l("span",{staticClass:"line-number"},[n._v("8")]),l("br"),l("span",{staticClass:"line-number"},[n._v("9")]),l("br"),l("span",{staticClass:"line-number"},[n._v("10")]),l("br"),l("span",{staticClass:"line-number"},[n._v("11")]),l("br"),l("span",{staticClass:"line-number"},[n._v("12")]),l("br"),l("span",{staticClass:"line-number"},[n._v("13")]),l("br"),l("span",{staticClass:"line-number"},[n._v("14")]),l("br"),l("span",{staticClass:"line-number"},[n._v("15")]),l("br"),l("span",{staticClass:"line-number"},[n._v("16")]),l("br"),l("span",{staticClass:"line-number"},[n._v("17")]),l("br"),l("span",{staticClass:"line-number"},[n._v("18")]),l("br"),l("span",{staticClass:"line-number"},[n._v("19")]),l("br"),l("span",{staticClass:"line-number"},[n._v("20")]),l("br"),l("span",{staticClass:"line-number"},[n._v("21")]),l("br"),l("span",{staticClass:"line-number"},[n._v("22")]),l("br"),l("span",{staticClass:"line-number"},[n._v("23")]),l("br"),l("span",{staticClass:"line-number"},[n._v("24")]),l("br"),l("span",{staticClass:"line-number"},[n._v("25")]),l("br"),l("span",{staticClass:"line-number"},[n._v("26")]),l("br"),l("span",{staticClass:"line-number"},[n._v("27")]),l("br"),l("span",{staticClass:"line-number"},[n._v("28")]),l("br"),l("span",{staticClass:"line-number"},[n._v("29")]),l("br")])]),l("h2",{attrs:{id:"_2-跨域方案"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#_2-跨域方案"}},[n._v("#")]),n._v(" 2. 跨域方案")]),n._v(" "),l("ul",[l("li",[n._v("Web页面地址 和 请求接口地址 协议 域名 端口号三者有一个不一样就是跨域，默认不能请求")]),n._v(" "),l("li",[n._v("解决方案\n"),l("ul",[l("li",[n._v("修改本地hosts:开发跨域，部署同源")]),n._v(" "),l("li",[n._v("JSONP\n"),l("ul",[l("li",[n._v("script标签的src请求资源文件[基于GET]，不存在跨域机制")]),n._v(" "),l("li",[n._v("需要服务器端支持")]),n._v(" "),l("li",[n._v("axios、fetch...默认基于promise")])])]),n._v(" "),l("li",[n._v("CORS\n"),l("ul",[l("li",[n._v("服务器端设置允许源，允许当前客户端发请求，避开浏览器的安全策略\naixos: withCredentails:")])])]),n._v(" "),l("li",[n._v("Proxy\n"),l("ul",[l("li",[n._v("利用后端和后端通信默认是没有安全策略的")]),n._v(" "),l("li",[n._v("中间代理服务器：预览页面 从其他服务器获取数据\n"),l("ul",[l("li",[n._v("开发环境\n"),l("ul",[l("li",[n._v("node.js 自己写")]),n._v(" "),l("li",[n._v("vue/react => webpack-dev-server")])])]),n._v(" "),l("li",[n._v("生产环境\n"),l("ul",[l("li",[n._v("nginx 反向代理")]),n._v(" "),l("li",[n._v("...")])])])])])])]),n._v(" "),l("li",[n._v("扩展：其他跨域方案「配合iframe」\n"),l("ul",[l("li",[n._v("postMessage")]),n._v(" "),l("li",[n._v("window.name")]),n._v(" "),l("li",[n._v("document.domin")]),n._v(" "),l("li",[n._v("location.hash")])])])])])])])}),[],!1,null,null,null);l.default=s.exports}}]);